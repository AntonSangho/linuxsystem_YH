# Day 10: 웹 서비스 운영/관리 실습

## 수업 개요

| 항목 | 내용 |
|------|------|
| 총 시간 | 5시간 |
| 주제 | 웹 서비스 운영/관리, 트러블슈팅, 운영 보고서 |
| 전제 조건 | Day 9에서 구축한 APM + gnuboard 환경 |

## 학습 목표

- 웹 서비스 상태 점검 및 서비스 관리
- 로그 확인 및 분석
- 데이터베이스 백업/복원
- 서비스 트러블슈팅

---

## 시간표

| 시간 | 내용 |
|------|------|
| 0.5h | Day 9 복습, 시스템 상태 점검 |
| 1.5h | 서비스 관리 (systemctl), 로그 분석 |
| 1.5h | DB 백업/복원, 방화벽, 보안 점검 |
| 0.5h | 트러블슈팅 실습 |
| 1h | 운영 보고서 작성 + 결과 발표 |

---

## 1. Day 9 복습 및 시스템 상태 점검 (0.5시간)

### 점검 항목

- Apache 서비스 동작 확인
- MariaDB 서비스 동작 확인
- gnuboard 웹 사이트 접속 확인
- 방화벽 상태 확인

### 주요 확인 명령어

- `systemctl status` 로 각 서비스 상태 확인
- 브라우저에서 gnuboard 접속 테스트
- `ufw status`로 방화벽 규칙 확인

---

## 2. 서비스 관리 및 로그 분석 (1.5시간)

### 서비스 관리 (systemctl)

`systemctl`은 리눅스에서 서비스(데몬)를 관리하는 핵심 명령어

| 명령 | 설명 |
|------|------|
| `systemctl start 서비스명` | 서비스 시작 |
| `systemctl stop 서비스명` | 서비스 중지 |
| `systemctl restart 서비스명` | 서비스 재시작 |
| `systemctl status 서비스명` | 서비스 상태 확인 |
| `systemctl enable 서비스명` | 부팅 시 자동 시작 설정 |
| `systemctl disable 서비스명` | 자동 시작 해제 |
| `systemctl list-units --type=service` | 전체 서비스 목록 확인 |

Day 9에서 설치한 서비스: `apache2`, `mariadb`

### 로그 분석

#### Apache 로그

| 로그 파일 | 설명 |
|-----------|------|
| `/var/log/apache2/access.log` | 접속 기록 (누가, 언제, 어떤 페이지) |
| `/var/log/apache2/error.log` | 오류 기록 |

#### MariaDB 로그

| 로그 파일 | 설명 |
|-----------|------|
| `/var/log/mysql/error.log` | MariaDB 오류 로그 |

#### 시스템 로그

- `journalctl` 명령어를 활용한 시스템 로그 확인
- 특정 서비스의 로그만 필터링하여 확인

### 로그 분석이 중요한 이유

- 서비스 장애 원인 파악의 첫 단계
- 보안 침입 시도 탐지 (비정상 접속 패턴)
- 실무에서 **"로그부터 확인"**이 트러블슈팅의 기본 원칙

### 로그 분석에 유용한 명령어

| 명령어 | 용도 |
|--------|------|
| `tail -f 로그파일` | 실시간으로 로그 확인 (새로운 내용이 추가되면 바로 표시) |
| `grep "키워드" 로그파일` | 특정 키워드가 포함된 줄만 검색 |
| `journalctl -u 서비스명` | 특정 서비스의 시스템 로그 확인 |
| `journalctl -u 서비스명 --since "1 hour ago"` | 최근 1시간 로그만 확인 |

---

## 3. DB 백업/복원 및 보안 점검 (1.5시간)

### 데이터베이스 백업

- `mysqldump` 명령어를 사용한 데이터베이스 백업
- 전체 DB 백업 / 특정 DB 백업 / 특정 테이블 백업
- 백업 파일(.sql) 저장 및 관리

#### 백업이 중요한 이유

- 서버 장애, 실수로 데이터 삭제 시 복구 가능
- 실무에서는 **자동 백업 + 정기 백업**이 필수
- 백업 없이 DB를 날리면 복구 불가능

#### 백업 방식 비교

| 방식 | 설명 | 특징 |
|------|------|------|
| `mysqldump` (논리적 백업) | SQL 문으로 내보내기 | 가장 기본, 이해하기 쉬움 |
| 파일 복사 (물리적 백업) | DB 파일 자체를 복사 | 빠르지만 서비스 중지 필요 |

이번 실습에서는 `mysqldump`를 사용한 논리적 백업을 진행

### 데이터베이스 복원

- `mysql` 명령어로 백업 파일 복원
- 복원 후 데이터 정합성 확인
- 복원 전에 대상 데이터베이스가 존재해야 함

### 방화벽 점검

- 현재 방화벽 규칙 검토
- 불필요한 포트 차단, 필요한 포트만 개방
- 웹 서비스에 필요한 포트: SSH(22), HTTP(80)

### 보안 점검

- MariaDB root 비밀번호 설정 확인
- 웹 디렉토리 파일 권한 점검
- 불필요한 서비스 비활성화

---

## 4. 트러블슈팅 실습 (0.5시간)

### 트러블슈팅 시나리오 예시

| 시나리오 | 증상 | 확인 방법 |
|----------|------|-----------|
| Apache 중지 | 웹 페이지 접속 불가 | `systemctl status apache2` |
| MariaDB 중지 | gnuboard DB 오류 | `systemctl status mariadb` |
| 방화벽 차단 | 외부에서 접속 불가 | `ufw status` |
| 권한 문제 | 403 Forbidden 오류 | 디렉토리/파일 권한 확인 |

### 트러블슈팅 절차

```
증상 확인 → 로그 확인 → 원인 분석 → 해결 → 검증
```

1. **증상 확인**: 어떤 오류가 발생하는지 정확히 파악
   - 브라우저 오류 메시지 (403, 404, 500 등)
   - 서비스 접속 불가 여부
2. **로그 확인**: 관련 로그 파일에서 오류 메시지 확인
   - Apache: `/var/log/apache2/error.log`
   - MariaDB: `/var/log/mysql/error.log`
3. **원인 분석**: 로그와 시스템 상태를 바탕으로 원인 파악
4. **해결 및 검증**: 조치 후 서비스 정상 동작 확인

### AI를 활용한 트러블슈팅

오류 메시지가 이해되지 않을 때 ChatGPT에 질문하는 템플릿:

```
[환경] Ubuntu 22.04, Apache 2.4, MariaDB
[상황] (무엇을 하다가 오류가 발생했는지)
[오류 메시지] (로그에서 복사한 오류 메시지)
[질문] 이 오류의 원인과 해결 방법을 알려주세요
```

---

## 5. 운영 보고서 작성 및 발표 (1시간)

### 보고서 포함 내용

1. **시스템 구성**: 설치한 서비스 목록 및 버전
2. **서비스 상태**: 각 서비스 동작 상태
3. **방화벽 설정**: 개방 포트 및 규칙
4. **백업 현황**: DB 백업 파일 위치 및 크기
5. **트러블슈팅 경험**: 발생한 문제와 해결 과정

### 발표 내용

1. **시스템 구성 설명** (2분)
   - Apache, PHP, MariaDB, gnuboard 각각의 역할
   - 전체 시스템 연동 방식

2. **운영 관리 시연** (3분)
   - 서비스 상태 확인
   - 로그 확인
   - 백업/복원 시연

3. **트러블슈팅 경험** (2분)
   - 겪었던 문제와 해결 방법
   - AI 도구 활용 경험

---

## 완료 체크리스트

### 서비스 관리

- [ ] Apache/MariaDB 서비스 상태 확인
- [ ] 서비스 시작/중지/재시작 실습
- [ ] 서비스 자동 시작 설정 확인

### 로그 분석

- [ ] Apache 접속/오류 로그 확인
- [ ] MariaDB 오류 로그 확인
- [ ] journalctl로 시스템 로그 확인

### 백업/복원

- [ ] mysqldump로 DB 백업
- [ ] 백업 파일로 DB 복원
- [ ] 복원 후 데이터 확인

### 보안

- [ ] 방화벽 규칙 점검
- [ ] 파일 권한 점검
- [ ] DB 사용자 권한 확인

### 제출

- [ ] 운영 보고서 작성
- [ ] 발표 준비

---

## 자주 하는 실수 및 해결

| 실수 | 해결 방법 |
|------|-----------|
| mysqldump 권한 오류 | `sudo mysqldump` 또는 `-u root -p` 옵션 사용 |
| 복원 시 DB가 없음 | 복원 전에 `CREATE DATABASE` 먼저 실행 |
| 로그 파일 못 찾음 | `/var/log/` 하위에서 서비스별 디렉토리 확인 |
| 서비스 재시작 후 접속 안 됨 | 설정 파일 문법 오류 확인 (`apache2ctl configtest`) |

---

## 2주 과정 요약

### 1주차 (Day 1~5)

| Day | 주제 | 핵심 내용 |
|-----|------|-----------|
| 1 | 환경 구축 | VMware, Ubuntu 설치 |
| 2 | 파일 시스템 | ls, cd, mkdir, rm, cp, mv |
| 3 | 셸 기초 | bash, alias, 리다이렉션, 파이프 |
| 4 | 권한/프로세스 | chmod, chown, ps, kill |
| 5 | 디스크/패키지 | df, du, mount, apt |

### 2주차 (Day 6~10)

| Day | 주제 | 핵심 내용 |
|-----|------|-----------|
| 6 | 사용자/그룹 | useradd, passwd, groupadd |
| 7 | 시스템 관리 | systemctl, apt, dpkg |
| 8 | 네트워크/SSH | ip, ping, ssh, scp |
| 9 | APM + gnuboard | MariaDB, Apache, PHP, gnuboard |
| 10 | 운영/관리 | 서비스 관리, 로그, 백업, 트러블슈팅 |

---

## 다음 단계 추천

### 실무 연계

1. **AWS EC2 실습**
   - EC2 인스턴스 생성
   - SSH로 접속
   - 웹 서버 구축

2. **라즈베리파이**
   - 데비안 계열 OS
   - SSH 원격 접속
   - ROS2 환경 구축

### 추가 학습

1. **Nginx** - Apache 대안 웹 서버
2. **Docker** - 컨테이너 기반 배포
3. **Git/GitHub** - 버전 관리 심화
4. **쉘 스크립트** - 자동화

---

## 수고하셨습니다!

2주간의 리눅스 시스템 과정을 완료하셨습니다.

배운 내용을 바탕으로:
- AWS EC2에서 서버 운영
- 라즈베리파이에서 ROS2 환경 구축
- 실무에서 리눅스 시스템 관리

를 수행할 수 있는 기초를 갖추셨습니다.

**기억하세요:**
- 모르면 `man 명령어` 또는 AI에게 질문
- 오류 메시지는 해결의 실마리
- 실습이 최고의 학습
